<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AutomatizaPro - Automação Inteligente para seu Negócio</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <nav class="nav-container">
            <a href="#" class="logo">
                <img src="logo.svg" alt="AutomatizaPro Logo" class="logo-img">
                <span>AutomatizaPro</span>
            </a>
            <div class="nav-controls">
                <div class="lang-buttons">
                    <button class="lang-btn active" data-lang="pt-BR">BR</button>
                    <button class="lang-btn" data-lang="pt-PT">PT</button>
                    <button class="lang-btn" data-lang="en">IN</button>
                </div>
                <button class="contact-btn">Contato</button>
            </div>
        </nav>
    </header>

    <main>
        <section class="hero">
            <div class="hero-animation">
                <div class="gear gear-1"></div>
                <div class="gear gear-2"></div>
                <div class="gear gear-3"></div>
            </div>
            <h1>Transforme seus Processos com Automação Inteligente</h1>
            <p class="subtitle">Você sabia que até 90% do tempo e 45% dos custos em tarefas repetitivas podem ser automatizados?</p>
            <p class="description">Reduza retrabalho, economize tempo e aumente a eficiência operacional</p>
            <a href="#form" class="cta-button">Receba sua Proposta Personalizada</a>
        </section>

        <section class="case-studies">
            <h2>Casos Reais de Automação</h2>
            <div class="case-studies-container">
                <!-- Cards serão inseridos via JavaScript -->
            </div>
            <div class="slider-controls">
                <button class="prev-btn">
                    <i data-lucide="chevron-left"></i>
                </button>
                <button class="next-btn">
                    <i data-lucide="chevron-right"></i>
                </button>
            </div>
            <div class="slider-dots">
                <!-- Pontos serão inseridos via JavaScript -->
            </div>
        </section>

        <section class="benefits">
            <h2>Benefícios Tangíveis da Automação</h2>
            <p class="subtitle">Transforme sua operação com benefícios reais e mensuráveis</p>
            <div class="benefits-grid">
                <!-- Cards serão inseridos via JavaScript -->
            </div>
        </section>

        <section class="implementation">
            <h2>Cronograma de Implantação</h2>
            <p class="subtitle">Um processo estruturado para garantir o sucesso da sua automação</p>
            <div class="implementation-steps">
                <!-- Cards serão inseridos via JavaScript -->
            </div>
        </section>

        <section class="testimonials">
            <h2>O Que Dizem Sobre As Automações</h2>
            <p class="subtitle">Histórias reais de transformação com automação inteligente</p>
            <div class="testimonials-container">
                <!-- Cards serão inseridos via JavaScript -->
            </div>
        </section>

        <section class="cta">
            <h2>Pronto para Transformar sua Operação?</h2>
            <p class="subtitle">Agende uma reunião para receber uma proposta personalizada de automação inteligente para seu negócio</p>
            <a href="#form" class="cta-button">Agendar Consultoria Gratuita</a>
        </section>

        <section class="form" id="form">
            <h2>Comece Agora</h2>
            <div class="form-container">
                <div class="form-features">
                    <h3>Por que automatizar com tecnologia exclusiva?</h3>
                    <ul>
                        <li><i data-lucide="check-circle"></i> Integração com mais de 200 aplicativos e serviços</li>
                        <li><i data-lucide="check-circle"></i> Fluxos de trabalho personalizados para seu negócio</li>
                        <li><i data-lucide="check-circle"></i> Automação de tarefas repetitivas e processos complexos</li>
                        <li><i data-lucide="check-circle"></i> Dashboards e relatórios em tempo real</li>
                        <li><i data-lucide="check-circle"></i> Suporte técnico especializado e contínuo</li>
                    </ul>
                </div>
                <form id="contact-form" method="POST" action="https://script.google.com/macros/s/AKfycbwXVYHATi89zeKkZI1HGbWj1cb3Z7KX_mP2H1wXJmlLG0hytYUmRFOxci2AjQZ_Lf3AYg/exec">
                    <input type="text" name="name" required placeholder="Nome">
                    <input type="email" name="email" required placeholder="Email">
                    <input type="tel" name="phone" required placeholder="Telefone">
                    <input type="text" name="company" required placeholder="Empresa">
                    <button type="submit">Enviar</button>
                    <p class="privacy">Seus dados estão seguros conosco. Não compartilhamos suas informações.</p>
                </form>
                <div id="form-status" style="margin-top: 15px; font-weight: bold; min-height: 1.2em;"></div>
            </div>
        </section>
    </main>

    <footer>
        <p>© 2024 AutomatizaPro. Todos os direitos reservados.</p>
        <p>As soluções podem variar de acordo com cada negócio.</p>
    </footer>

    <script src="script.js"></script>
    <script>
        // Garante que o script só roda depois que o HTML foi completamente carregado
        document.addEventListener('DOMContentLoaded', (event) => {
            
            const form = document.getElementById('contact-form'); // Usa o ID do seu formulário
            const statusDiv = document.getElementById('form-status'); // Usa o ID da div de status

            // Verifica se ambos os elementos essenciais foram encontrados
            if (!form) {
                console.error('Erro Crítico: Formulário com ID "contact-form" não encontrado no DOM.');
                return; // Interrompe a execução do script se o form não existe
            }
            if (!statusDiv) {
                console.error('Erro Crítico: Elemento com ID "form-status" não encontrado no DOM.');
                // Poderia continuar sem a div de status, mas é melhor avisar.
                // Se quiser que funcione sem a div, remova este 'if' e as linhas que usam statusDiv.
            }

            // Adiciona o listener ao evento de submit do formulário
            form.addEventListener('submit', function(e) {
                e.preventDefault(); // Impede o comportamento padrão de submit (recarregar página)

                const formData = new FormData(form);
                
                // Mostra mensagem de envio e desabilita botão
                if (statusDiv) {
                    statusDiv.innerHTML = 'Enviando seus dados, aguarde...';
                    statusDiv.style.color = '#333'; // Cor neutra
                    statusDiv.style.display = 'block'; // Garante visibilidade
                }
                const submitButton = form.querySelector('button[type="submit"]');
                if (submitButton) {
                    submitButton.disabled = true;
                    submitButton.style.opacity = 0.7; 
                }

                // Envia os dados usando Fetch API para a URL definida no 'action' do form
                fetch(form.action, { 
                    method: 'POST',
                    body: formData,
                })
                .then(response => {
                    // Verifica se a resposta da rede foi bem sucedida (status 2xx)
                    if (!response.ok) {
                        // Se não foi OK, tenta ler o corpo da resposta como texto para dar mais detalhes
                        return response.text().then(text => {
                            // Lança um erro que será pego pelo .catch()
                            throw new Error(`Erro do Servidor: ${response.status} ${response.statusText}. Detalhes: ${text}`);
                        });
                    }
                    // Se a resposta foi OK, tenta processá-la como JSON
                    return response.json(); 
                })
                .then(data => {
                    // Processa a resposta JSON do Apps Script
                    if (data.result === 'success') {
                        if (statusDiv) {
                            statusDiv.innerHTML = 'Obrigado! Seus dados foram enviados com sucesso.';
                            statusDiv.style.color = 'green'; 
                        }
                        form.reset(); // Limpa o formulário
                        console.log('Formulário enviado com sucesso. Resposta:', data);
                    } else {
                        // Se o Apps Script retornou {result: 'error', error: '...'}
                        if (statusDiv) {
                            statusDiv.innerHTML = 'Ops! Ocorreu um erro ao processar seus dados. Tente novamente.';
                            statusDiv.style.color = 'red';
                        }
                        // Loga o erro específico retornado pelo script
                        console.error('Erro retornado pelo Apps Script:', data.error || 'Erro desconhecido retornado pelo script.');
                    }
                })
                .catch(error => {
                    // Captura erros de rede, falha na conversão para JSON, ou o erro lançado pelo !response.ok
                    console.error('Erro durante o envio ou processamento da resposta:', error);
                    if (statusDiv) {
                        statusDiv.innerHTML = 'Erro de comunicação ao enviar. Verifique sua conexão ou tente mais tarde.';
                        statusDiv.style.color = 'red'; 
                    }
                })
                .finally(() => {
                    // Bloco 'finally' sempre executa, após sucesso ou erro do 'fetch'
                    // Reabilita o botão de submit
                    if (submitButton) {
                        submitButton.disabled = false;
                        submitButton.style.opacity = 1;
                    }
                    // Esconde a mensagem de status após um tempo
                    if (statusDiv) {
                        setTimeout(() => {
                            if (statusDiv.style.display !== 'none') { // Só esconde se ainda estiver visível
                                statusDiv.style.display = 'none';
                                statusDiv.innerHTML = ''; 
                            }
                        }, 7000); // 7 segundos
                    }
                });
            }); // Fim do form.addEventListener

        }); // Fim do document.addEventListener('DOMContentLoaded')
    </script>
</body>
</html>
